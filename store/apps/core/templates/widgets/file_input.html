{# --"--\Catalog\store\apps\core\templates\widgets\file_input.html"-- #}
{% load i18n %}
<div class="form-field">
  {# Контейнер виджета #}
  <div id="{{ widget.container_id }}"
    class="file-upload-container" {# JS добавит класс 'upload-error' сюда при ошибке фронтенда #}
    data-config="{{ widget.config_json|escape }}">
    <div class="file-field-header">
      {% if widget.label %}
        <span id="{{ widget.attrs.id }}-label" class="file-field-label">
          {{ widget.label }}
          {% if widget.is_required %}<span class="required-indicator">*</span>{% endif %}
        </span>
      {% endif %}
      <div class="file-field-actions">
        <button type="button"
                class="file-action-button"
                id="{{ widget.select_btn_id }}">
          <i class="fas fa-plus"></i>{% trans "Select" %}
        </button>
        <button type="button"
                class="file-action-button"
                id="{{ widget.clear_btn_id }}">
          <i class="fas fa-trash-alt"></i>{% trans "Clear All" %}
        </button>
      </div>
    </div>
    <div class="dropzone"
         id="{{ widget.dropzone_id }}"
         role="group"
         aria-labelledby="{{ widget.attrs.id }}-label">
      <input type="file"
        name="{{ widget.name }}"
        id="{{ widget.attrs.id }}"
        class="file-input" {# Django добавит класс 'error' сюда при серверной ошибке #}
        {% if widget.allow_multiple_selected %}multiple{% endif %}
        {% for attr_name, attr_value in widget.attrs.items %}
          {% if attr_name != "id" and attr_name != "class" and attr_name != "multiple" and attr_name != "name" %}
            {{ attr_name }}{% if attr_value is not True %}="{{ attr_value }}"{% endif %}
          {% endif %}
        {% endfor %}
        >
        <div class="dropzone-content">
          <div class="dropzone-icon">
            <i class="fas fa-cloud-upload-alt"></i>
          </div>
          <div class="dropzone-text">{% trans "Drag & drop files here" %}</div>
          <div class="dropzone-subtext">{% trans "Or click to browse your device" %}</div>
          <span class="dropzone-button">{% trans "Browse Files" %}</span>
        </div>
      </div>
      <p class="file-restrictions-info" id="{{ widget.restrictions_id }}">{% trans "Loading restrictions..." %}</p>
      {# Контейнер для ошибок ФРОНТЕНДА (JS) #}
      <div class="file-error-text hidden" id="{{ widget.error_id }}">
        {% comment %} Сюда JS будет вставлять текст ошибки {% endcomment %}
      </div>
      <div class="file-preview-container" id="{{ widget.preview_id }}">
        {# File previews will be added here by JavaScript #}
      </div>
    </div>
  </div>
