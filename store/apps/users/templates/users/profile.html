{# --"--\Catalog\store\apps\users\templates\users\profile.html"-- #}
{% extends 'base.html' %}
{% load i18n static compress %}
{% block title %}
  {% trans "User Profile" %}
{% endblock title %}
{% block css %}
  {% compress css %}
    <link rel="stylesheet"
          href="{% static 'scss/pages/profile.scss' %}"
          type="text/x-scss">
  {% endcompress %}
{% endblock css %}
{% block content %}
  <div class="container">
    <div class="profile-container">
      <h1 class="profile-title">{% trans "User Profile" %}</h1>
      <div class="profile-info-section">
        <h2 class="profile-section-title">{% trans "Personal Information" %}</h2>
        <div class="profile-field-group" id="personal-fields">
          {% for field in personal_fields %}
            <div class="profile-field {% if field.editable %}editable{% endif %}"
                 data-field-name="{{ field.name }}">
              <span class="field-label">
                <i class="fas fa-{% if field.name == 'username' %}user{% elif field.name == 'first_name' %}user{% elif field.name == 'last_name' %}user{% else %}question{% endif %}"></i>
                {{ field.label }}
              </span>
              <div class="field-value">{{ field.value|default:"-" }}</div>
              {% if field.editable %}<span class="edit-icon"><i class="fas fa-pencil-alt"></i></span>{% endif %}
            </div>
          {% endfor %}
        </div>
        <h2 class="profile-section-title">{% trans "Contact Information" %}</h2>
        <div class="profile-field-group" id="contact-fields">
          {% for field in contact_fields %}
            <div class="profile-field {% if field.editable %}editable{% endif %}"
                 data-field-name="{{ field.name }}">
              <span class="field-label">
                <i class="fas fa-{% if field.name == 'email' %}envelope{% elif field.name == 'phone_number' %}phone{% elif field.name == 'city' %}city{% else %}question{% endif %}"></i>
                {{ field.label }}
              </span>
              <div class="field-value">{{ field.value|default:"-" }}</div>
              {% if field.editable %}<span class="edit-icon"><i class="fas fa-pencil-alt"></i></span>{% endif %}
            </div>
          {% endfor %}
        </div>
        <h2 class="profile-section-title">{% trans "Additional Information" %}</h2>
        <div class="profile-field-group" id="additional-fields">
          {% for field in additional_fields %}
            <div class="profile-field {% if field.editable %}editable{% endif %}"
                 data-field-name="{{ field.name }}">
              <span class="field-label">
                <i class="fas fa-{% if field.name == 'date_joined' %}calendar-alt{% elif field.name == 'is_active' %}info-circle{% elif field.name == 'last_login' %}clock{% elif field.name == 'is_staff' %}user-shield{% else %}question{% endif %}"></i>
                {{ field.label }}
              </span>
              <div class="field-value">{{ field.value|default:"-" }}</div>
              {% if field.editable %}<span class="edit-icon"><i class="fas fa-pencil-alt"></i></span>{% endif %}
            </div>
          {% endfor %}
        </div>
      </div>
      <div class="profile-actions">
        <a href="#" class="profile-button secondary"><i class="fas fa-key"></i> {% trans "Change Password" %}</a>
        <form action="{% url 'users:logout' %}"
              method="post"
              style="display: inline">
          {% csrf_token %}
          <button type="submit" class="profile-button danger">
            <i class="fas fa-sign-out-alt"></i> {% trans "Logout" %}
          </button>
        </form>
      </div>
    </div>
  </div>
  <!-- Field Edit Modal -->
  <div class="modal-overlay" id="field-edit-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="edit-modal-title">{% trans "Edit Field" %}</h3>
        <button class="modal-close" data-modal-close aria-label="{% trans 'Close' %}">Ã—</button>
      </div>
      <div class="modal-body">
        <form id="field-edit-form" method="post" action="{% url 'users:profile' %}">
          {% csrf_token %}
          <input type="hidden" name="field_name" id="field-edit-name">
          <div class="form-group">
            <label for="field-edit-value" class="form-label" id="field-edit-label">{% trans "Value" %}:</label>
            <input type="text"
                   id="field-edit-value"
                   name="field_value"
                   class="form-control">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="profile-button secondary" data-modal-close>{% trans "Cancel" %}</button>
        <button type="submit"
                class="profile-button"
                id="field-edit-save"
                form="field-edit-form">{% trans "Save" %}</button>
      </div>
    </div>
  </div>
{% endblock content %}
{% block extra_js %}
  <script type="module" src="{% static 'js/pages/profile.js' %}"></script>
{% endblock extra_js %}
